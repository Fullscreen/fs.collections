(function(){angular.module("fs.collections",[])}).call(this);
(function(){var t,e=[].slice;t=angular.module("fs.collections"),t.factory("BaseCollection",["$http","BaseModel",function(t,r){var n,o,i;return n=function(){function e(t,e){var r,n,o;this.opts=e,o=this.opts;for(r in o)n=o[r],this[r]=n;this.models=[],this.length=0,this.add(t)}return e.prototype.model=r,e.prototype.currentlyFetching=!1,e.prototype.url=function(){},e.prototype.parse=function(t){return t.data},e.prototype.fetch=function(e){var r,n;return r={method:"GET",url:_(this).result("url")},e=_.extend(r,e),e.params&&(e.params=_.extend({},e.params)),e.data&&(e.data=_.extend({},e.data)),this.currentlyFetching=!0,n=t(e).then(_.bind(this.parse,this)).then(function(t){return function(r){return e.reset&&t.reset(),t.add(r),t}}(this)),n["finally"](function(t){return function(){return t.currentlyFetching=!1}}(this)),n},e.prototype.eq=function(t){var e;return null!=(e=this.models)?e[t]:void 0},e.prototype.get=function(t){return _(this.models).findWhere({id:t})},e.prototype.remove=function(t){var e,r;return e=!_(t).isArray(),e&&(t=[t]),r=[],_(t).forEach(function(t){return function(e){var n;return n=t.indexOf(e),-1!==n?(r.push(e),t.models.splice(n,1),t.length--):void 0}}(this)),e?r[0]:r},e.prototype.add=function(t,e){var r,n,o;if(t)return e=_.extend({sort:!0},e),o=!_(t).isArray(),t=o?[t]:t.slice(),r=[],n="undefined"==typeof e.at?this.length:e.at,t.forEach(function(t){return function(e){return e=t._prepareModel(e),null==t.get(e.id)?(r.push(e),t.length++,t.models.splice(n,0,e),n++):void 0}}(this)),e.sort&&this.sort(),o?r[0]:r},e.prototype.create=function(t){var e;return e=this.add(t),e?e.save():void 0},e.prototype.clone=function(){return new this.constructor(this.toJSON(),this.opts)},e.prototype.toJSON=function(){return _.map(this.models,function(t){return t.toJSON()})},e.prototype.reset=function(){return this.models=[],this.length=0,this},e.prototype.sort=function(){return this.models.sort(this.comparator?this.comparator:function(t,e){return t.id-e.id})},e.prototype._prepareModel=function(t){var e;return t instanceof this.model?(e=t,e.collection=this):e=new this.model(t,{collection:this}),e},e.prototype.pluck=function(t){return _.invoke(this.models,"get",t)},e.prototype.where=function(t,e){return t?this[e?"find":"filter"](function(e){var r,n;for(r in t)if(n=t[r],t[r]!==e.get(r))return!1;return!0}):e?void 0:[]},e.prototype.findWhere=function(t){return this.where(t,!0)},e}(),i=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"],_.each(i,function(t){return n.prototype[t]=function(){var r;return r=1<=arguments.length?e.call(arguments,0):[],r.unshift(this.models),_[t].apply(_,r)}}),o=["groupBy","countBy","sortBy"],_.each(o,function(t){return n.prototype[t]=function(e,r){var n;return n=_.isFunction(e)?e:function(t){return t.get(e)},_[t](this.models,n,r)}}),n}])}).call(this);
(function(){var t,e=[].slice;t=angular.module("fs.collections"),t.factory("BaseModel",["$http",function(t){var i,r;return i=function(){function e(t,e){var i,r;null==t&&(t={}),null==e&&(e={});for(i in e)r=e[i],this[i]=r;this.attributes={},t=_.extend({},t),t=_.defaults(t,_.result(this,"defaults")),this.set(t)}return e.prototype.parse=function(t){return t.data},e.prototype._hasIdAttribute=function(t){return _(Object.keys(t)).contains(this.idAttribute)},e.prototype.has=function(t){return null!=this.attributes[t]},e.prototype.get=function(t){return this.attributes[t]},e.prototype.set=function(t,e){var i,r,n;if(!t)return this;"object"==typeof t?n=t:(n={},n[t]=e),this._hasIdAttribute(n)&&(this.id=n[this.idAttribute]);for(i in n)r=n[i],this.attributes[i]=r;return this},e.prototype.urlRoot="",e.prototype.idAttribute="id",e.prototype.isNew=function(){return null!=this.id?!1:!0},e.prototype.url=function(){var t,e;return t=_.result(this,"urlRoot")||_.result(this.collection,"url"),this.isNew()?t:(e=encodeURIComponent(this.id),t+("/"===t.charAt(t.length-1)?e:"/"+e))},e.prototype.toJSON=function(){return _.clone(this.attributes)},e.prototype.fetch=function(e){var i;return null==e&&(e={}),i=_.extend({},e),_(i).defaults({method:"GET",url:_.result(this,"url")}),t(i).then(_(this.parse).bind(this)).then(_(this.set).bind(this))},e.prototype.save=function(e){var i;return null==e&&(e={}),i=_.extend({},e),_(i).defaults({method:this.isNew()?"POST":"PUT",url:_.result(this,"url"),data:this.toJSON()}),t(i).then(_(this.parse).bind(this)).then(_(this.set).bind(this))},e.prototype.destroy=function(e){return null==e&&(e={}),this.collection&&this.collection.remove(this),this.isNew()?void 0:(_(e).defaults({method:"DELETE",url:this.url("delete")}),t(e).then(_(this.parse).bind(this)))},e}(),r=["keys","values","pairs","invert","pick","omit"],_.each(r,function(t){return i.prototype[t]=function(){var i;return i=1<=arguments.length?e.call(arguments,0):[],i.unshift(this.attributes),_[t].apply(_,i)}}),i}])}).call(this);